CAUTION: DO NOT USE THIS

I'm still adapting this code a lot. Given what it does, it is likely to become a core part of any code you use it in. And if I then make a little change, you will have to refactor or worse rewrite your code.